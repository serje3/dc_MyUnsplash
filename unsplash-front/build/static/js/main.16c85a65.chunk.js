(this["webpackJsonpunsplash-front"]=this["webpackJsonpunsplash-front"]||[]).push([[0],[,,,,,,,,,,,,,,,,,function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},,function(e,t,n){},function(e,t,n){},function(e,t,n){"use strict";n.r(t);var r=n(1),a=n.n(r),o=n(12),s=n.n(o),i=n(10),c=(n(17),n(18),n(19),n(20),n(21),n.p+"static/media/search_black_24dp.f03572ee.svg"),l=(n(22),n(2)),u=n(3),d=n(5),h=n(4),m=n(11),p=n(9),j=n.n(p),f=n(6),b=n.n(f),v=function(){function e(){var t=this;Object(l.a)(this,e),this.handleErrors=function(e,t){switch(e.status){case 0:return void alert("Not connect. Verify Network.");case 404:return void alert("Requested page not found (404).");case 500:return void alert("Internal Server Error (500).")}switch(t){case"parsererror":return void alert("Requested JSON parse failed.");case"timeout":return void alert("Time out error.");case"abort":return void alert("Ajax request aborted.");default:return void alert("Uncaught Error. "+e.responseText)}},this.sendRequest=function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"GET",r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a=arguments.length>3?arguments[3]:void 0,o=t.parseFormData(r);return j.a.ajax(Object(m.a)(Object(m.a)({url:e,method:n,data:o,headers:{"X-CSRFToken":b.a.get("csrftoken"),Authorization:"Bearer "+b.a.get("access")}},t.settings),a))},this.settings={contentType:!1,processData:!1,error:this.handleErrors}}return Object(u.a)(e,[{key:"parseFormData",value:function(e){var t=new FormData;return j.a.each(e,(function(e,n){t.append(e,n)})),t}}]),e}(),g="https://151-248-121-170.cloudvps.regruhosting.ru",O={API:{IMAGE:{REQUEST:{url:g+"/api/v2/image",body:{POST:["label","img_url","img_file"]}},DELETE:{url:g+"/api/v2/image/delete/",kwargs:["pk"]}},AUTH:{CREATE_USER:{url:g+"/auth/users/",body:{POST:["username","password"]}},GET_USER:{url:g+"/auth/users/me/"},JWT_CREATE:{url:g+"/auth/jwt/create/",body:{POST:["username","password"]}},JWT_REFRESH:{url:g+"/auth/jwt/refresh",body:{POST:["refresh"]}}}}},_=function(e){Object(d.a)(n,e);var t=Object(h.a)(n);function n(){var e;return Object(l.a)(this,n),(e=t.call(this)).authorizationCheck(),e}return Object(u.a)(n,[{key:"user",get:function(){return n._user}},{key:"authorizationCheck",value:function(){var e=this;this.sendRequest(O.API.AUTH.GET_USER.url,"GET",void 0,{error:function(){}}).done((function(e){n.user=e.username})).fail((function(t,n,r){"Unauthorized"===r&&e.refreshToken().done((function(){window.location.reload()}))}))}},{key:"loginUser",value:function(e,t){var r=this;return this.sendRequest(O.API.AUTH.JWT_CREATE.url,"POST",{username:e,password:t}).fail((function(a,o,s){"Unauthorized"===s&&(n.user="",r.registerUser(e,t))})).done((function(t){n.saveJWT(t.access,t.refresh),n.user=e}))}},{key:"registerUser",value:function(e,t){var n=this;return this.sendRequest(O.API.AUTH.CREATE_USER.url,"POST",{username:e,password:t},{headers:{"X-CSRFToken":b.a.get("csrftoken")}}).done((function(r){n.loginUser(e,t)})),!1}},{key:"refreshToken",value:function(){var e=this;return this.sendRequest(O.API.AUTH.JWT_REFRESH.url,"POST",{refresh:localStorage.getItem("refresh")},{error:function(){}}).done((function(t){n.saveJWT(t.access,t.refresh),e.authorizationCheck()})).fail((function(e,t,n){"Unauthorized"===n&&alert("Login to see or add image")}))}}],[{key:"user",set:function(e){n._user=e}},{key:"saveJWT",value:function(e,t){b.a.set("access",e),localStorage.setItem("refresh",t)}}]),n}(v);_._user="";var x,y={PhotoFormRef:a.a.createRef(),PasswordFormRef:a.a.createRef(),LoginFormRef:a.a.createRef()},w=function(e){Object(d.a)(n,e);var t=Object(h.a)(n);function n(){var e;Object(l.a)(this,n);for(var r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];return(e=t.call.apply(t,[this].concat(a))).getImages=function(t){return e.sendRequest(O.API.IMAGE.REQUEST.url,"GET",void 0,{error:function(){}}).done((function(e){t(e)})).fail((function(e,t,n){"Unauthorized"===n?alert("Login to see or add image"):alert("[".concat(n||t+" status: "+e.status,"] Some shit happened.... on get images. "))}))},e.postImage=function(t,n){return e.sendRequest(O.API.IMAGE.REQUEST.url,"POST",t,{error:function(){}}).done((function(e){return n(e)})).fail((function(e,t,n){"Unauthorized"===n?alert("Login to add image"):alert("[".concat(n||t+" status: "+e.status,"]Some shit happened.... on create images"))}))},e.deleteImage=function(t,n,r,a){return e.sendRequest(O.API.IMAGE.DELETE.url+t,"DELETE",{username:n,password:r}).done((function(e){return a(e)})).fail((function(e,t,n){"Unauthorized"===n?alert("Login to delete images"):alert("[".concat(n||t+" status: "+e.status,"]Some shit happened.... on delete images"))}))},e}return n}(v),C=void 0,S={form:{openButton:{onClick:function(e){var t;null===(t=e.current)||void 0===t||t.style.setProperty("display","block"),setTimeout((function(){var t;return null===(t=e.current)||void 0===t?void 0:t.classList.add("appear")}),100)}},cancelButton:{onClick:function(e){var t;null===(t=e.current)||void 0===t||t.classList.remove("appear"),setTimeout((function(){var t;return null===(t=e.current)||void 0===t?void 0:t.style.setProperty("display","none")}),350)}},loginForm:{onSubmit:function(e){e.preventDefault();var t=new _,n=document.querySelector("#username__login"),r=document.querySelector("#password__login");n&&r&&n.value&&r.value?(t.loginUser(n.value,r.value).then((function(){window.location.reload()})),S.form.cancelButton.onClick(y.LoginFormRef),n.value="",r.value=""):alert("No data input fields were found:(")}},photoForm:{onSubmit:function(e){if(console.log(e,C),e.preventDefault(),"object"===typeof e.target&&null!==e.target){var t=e.target[0].value,n=e.target[1].value;(new w).postImage({label:t,img_url:n},console.log.bind(C,"postImage")).then((function(){window.location.reload()})),e.target[0].value="",e.target[1].value=""}else alert("Something went wrong")}},passwordForm:{onSubmit:function(e){e.preventDefault();var t=e.target[0].value,n=e.target[1].value,r=e.target[2].value;(new w).deleteImage(r,n,t,console.log.bind(C,"deleteImage")).done((function(){window.location.reload()}))}}},images:{photoDeleteButton:{onClick:function(e,t){if("object"===typeof t&&null!==t&&"props"in t){var n=document.getElementById("input__pk__hidden");n&&"value"in n&&(n.value=t.props["data-pk"],S.form.openButton.onClick(e))}}},inputUrl:{onChange:function(e){e.target}},inputSearch:{onChange:function(e,t){var n=function(t){var n=RegExp(e.target.value.toLowerCase());return void 0===t?[]:t.filter((function(e){var t;return null!==(null===e||void 0===e||null===(t=e.props)||void 0===t?void 0:t.alt.toLowerCase().match(n))}))};t((function(){return n}))}}}},T=n(0),k=void 0,N=function(e){return Object(T.jsx)("div",{className:"header",children:Object(T.jsxs)("div",{className:"wrapper__header",children:[Object(T.jsxs)("div",{className:"logo__header",onClick:function(){return window.location.href="/"},children:[Object(T.jsxs)("div",{className:"img__logo",children:[Object(T.jsx)("div",{className:"top__logo"}),Object(T.jsx)("div",{className:"bottom__logo"})]}),Object(T.jsxs)("div",{className:"text__logo",children:[Object(T.jsx)("div",{className:"top_text__logo",children:"My Unsplash"}),Object(T.jsx)("div",{className:"bottom_text__logo",children:"devchallenges.io"})]})]}),Object(T.jsxs)("div",{className:"search__header",onClick:function(e){console.log(e),"search__header"===e.target.className&&(console.log(e.target),e.target.children[1].focus())},children:[Object(T.jsx)("img",{src:c,alt:"search",className:"img__search"}),Object(T.jsx)("input",{type:"text",className:"input__search",placeholder:"Search by name",onChange:function(t){return S.images.inputSearch.onChange(t,e.setFilterImages)}})]}),Object(T.jsx)("div",{className:"login__header",onClick:S.form.openButton.onClick.bind(k,y.LoginFormRef),style:e.username?{justifyContent:"start"}:void 0,children:e.username||"Login"}),Object(T.jsx)("div",{className:"add__header",onClick:S.form.openButton.onClick.bind(k,y.PhotoFormRef),children:"Add a photo"})]})})};n(24);!function(e){e[e.First=0]="First",e[e.Second=1]="Second",e[e.Third=2]="Third"}(x||(x={}));var E,R=function(e){Object(d.a)(n,e);var t=Object(h.a)(n);function n(){return Object(l.a)(this,n),t.apply(this,arguments)}return Object(u.a)(n,[{key:"render",value:function(){var e,t=this.props.children||{};return Object(T.jsxs)("figure",{children:[Object(T.jsxs)("div",{className:"pre_img",children:[Object(T.jsx)("div",{className:"text__pre",children:null===(e=t.props)||void 0===e?void 0:e.alt}),Object(T.jsx)("div",{className:"delete__pre",onClick:S.images.photoDeleteButton.onClick.bind(this,y.PasswordFormRef,this.props.children),children:"delete"})]}),this.props.children]})}}]),n}(a.a.Component),F=function(e){Object(d.a)(n,e);var t=Object(h.a)(n);function n(){var e;Object(l.a)(this,n);for(var r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];return(e=t.call.apply(t,[this].concat(a))).getContentColumn=function(t){var n=e.props.order;return function(){var e=[];return n.forEach((function(n){t+1<=n.length&&e.push(n[t])})),e}().map((function(e,t){return Object(T.jsx)(R,{children:e},t)}))},e}return Object(u.a)(n,[{key:"render",value:function(){return Object(T.jsx)("div",{className:"col",style:{justifyContent:2===this.props.column&&2===this.props.columnCount?"start":"end"},children:this.getContentColumn(this.props.column)})}}]),n}(a.a.Component);!function(e){e[e.One=1]="One",e[e.Two=2]="Two",e[e.Three=3]="Three"}(E||(E={}));var A=function(e){Object(d.a)(n,e);var t=Object(h.a)(n);function n(){var e;Object(l.a)(this,n);for(var r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];return(e=t.call.apply(t,[this].concat(a))).getStyles=function(){return{gridTemplateColumns:"repeat(".concat(e.props.columnCount,", minmax(0,1fr))"),justifyItems:1===e.props.columnCount?"center":"end",maxWidth:2===e.props.columnCount?"850px":"inherit",marginLeft:"auto",marginRight:"auto"}},e.isEmpty=function(){return document.querySelectorAll(".col").forEach((function(e){if(e.childElementCount>0)return!1})),!0},e.getOrder=function(){var t=e.props.children;if(e.props.filterImages&&(t=e.props.filterImages(e.props.children)||[]),Array.isArray(t)){var n=[];return t.forEach((function(t,r){var a=Math.trunc(r/(e.props.columnCount||E.Three));n[a]||n.push([]),n[a].push(t)})),n}return[[t]]},e.getColumns=function(){for(var t=e.getOrder(),n=[],r=x.First;r<(e.props.columnCount||3);r++)n.push(Object(T.jsx)(F,{column:r,order:t,children:e.props.children},r));return n},e}return Object(u.a)(n,[{key:"render",value:function(){return this.props.children?Object(T.jsx)("div",{className:"images",style:this.getStyles(),children:this.getColumns()}):Object(T.jsx)("div",{className:"images",children:"No^)"})}}]),n}(a.a.Component),P=function(e){Object(d.a)(n,e);var t=Object(h.a)(n);function n(e){var r,a;return Object(l.a)(this,n),(a=t.call(this,e)).state={style:{display:(null===(r=a.props.style)||void 0===r?void 0:r.display)||"none"}},a}return Object(u.a)(n,[{key:"render",value:function(){return Object(T.jsx)("div",{ref:this.props.reference,className:"window__wrapper",style:this.state.style,children:Object(T.jsx)("form",{method:this.props.method,onSubmit:this.props.onSubmit,children:this.props.children})})}}]),n}(a.a.Component),I=function(e){Object(d.a)(n,e);var t=Object(h.a)(n);function n(){return Object(l.a)(this,n),t.apply(this,arguments)}return Object(u.a)(n,[{key:"render",value:function(){return Object(T.jsx)(P,{method:"POST",actionUrl:"/",onSubmit:function(e){S.form.photoForm.onSubmit(e)},reference:y.PhotoFormRef,children:Object(T.jsxs)("div",{className:"card add_photo_card",children:[Object(T.jsx)("div",{className:"title__card",children:"Add a new photo"}),Object(T.jsxs)("div",{className:"label__card",children:[Object(T.jsx)("div",{className:"text__label",children:"Label"}),Object(T.jsx)("input",{type:"text",className:"input__label",name:"label",placeholder:"Suspendisse elit massa",required:!0})]}),Object(T.jsxs)("div",{className:"url__card",children:[Object(T.jsx)("div",{className:"text__url",children:"Photo URL"}),Object(T.jsx)("input",{type:"url",className:"input__url",name:"url",placeholder:"https://images.unsplash.com/photo-1584395630827-860eee694d7b?ixlib=r...",onChange:S.images.inputUrl.onChange,required:!0})]}),Object(T.jsx)("input",{type:"submit",className:"submit__card",value:"Submit"}),Object(T.jsx)("div",{className:"cancel__card",onClick:S.form.cancelButton.onClick.bind(this,y.PhotoFormRef),children:"Cancel"})]})})}}]),n}(a.a.Component),U=function(e){Object(d.a)(n,e);var t=Object(h.a)(n);function n(){return Object(l.a)(this,n),t.apply(this,arguments)}return Object(u.a)(n,[{key:"render",value:function(){return Object(T.jsx)(P,{method:"DELETE",actionUrl:"/",onSubmit:S.form.passwordForm.onSubmit,reference:y.PasswordFormRef,children:Object(T.jsxs)("div",{className:"card enter_password_card",children:[Object(T.jsx)("div",{className:"title__card",children:"Are you sure?"}),Object(T.jsxs)("div",{className:"password__card",children:[Object(T.jsx)("div",{className:"text__password",children:"Password"}),Object(T.jsx)("input",{type:"password",className:"input__password",autoComplete:"no",placeholder:"******************",required:!0})]}),Object(T.jsx)("input",{type:"text",id:"input__username__hidden",name:"username",defaultValue:this.props.username,hidden:!0}),Object(T.jsx)("input",{type:"text",id:"input__pk__hidden",name:"pk",hidden:!0}),Object(T.jsx)("input",{type:"submit",className:"delete__card",value:"Delete"}),Object(T.jsx)("div",{className:"cancel__card_1",onClick:S.form.cancelButton.onClick.bind(this,y.PasswordFormRef),children:"Cancel"})]})})}}]),n}(a.a.Component),L=function(e){Object(d.a)(n,e);var t=Object(h.a)(n);function n(){return Object(l.a)(this,n),t.apply(this,arguments)}return Object(u.a)(n,[{key:"render",value:function(){return Object(T.jsx)(P,{method:"POST",actionUrl:"/",onSubmit:S.form.loginForm.onSubmit,reference:y.LoginFormRef,children:Object(T.jsxs)("div",{className:"card login_card",children:[Object(T.jsx)("div",{className:"title__card",children:"Login or Register"}),Object(T.jsxs)("div",{className:"username__card",children:[Object(T.jsx)("div",{className:"text__label",children:"Username"}),Object(T.jsx)("input",{type:"text",id:"username__login",className:"input__label",name:"username",placeholder:"John",required:!0})]}),Object(T.jsxs)("div",{className:"password__card",children:[Object(T.jsx)("div",{className:"text__password",children:"Password"}),Object(T.jsx)("input",{type:"password",id:"password__login",className:"input__password",name:"password",autoComplete:"no",placeholder:"******************",required:!0})]}),Object(T.jsx)("input",{type:"submit",className:"submit__card",value:"Login"}),Object(T.jsx)("div",{className:"cancel__card",onClick:S.form.cancelButton.onClick.bind(this,y.LoginFormRef),children:"Cancel"})]})})}}]),n}(a.a.Component),q=n(7),D=function(e){Object(d.a)(n,e);var t=Object(h.a)(n);function n(e){var r;return Object(l.a)(this,n),(r=t.call(this,e)).client=void 0,r.imagesClient=void 0,r.handleStates=function(e){r.setState({response:e})},r.parseImages=function(){var e=function(e){var t=[];return Array.isArray(e)?(console.log(e),e.forEach((function(e,n){t.push(Object(T.jsx)("img",{src:e.img_file,alt:e.label,"data-pk":e.pk},n.toString()))}))):(console.log("Something went wrong: "+e),t=[Object(T.jsx)(T.Fragment,{children:"Error"})]),t}(r.state.response);r.setState({images:e}),r.props.saveImage(e)},r.client=r.props.client,r.state={response:{},handleStates:r.handleStates,images:[Object(T.jsx)(T.Fragment,{children:"Error"})]},r.imagesClient=new w,r}return Object(u.a)(n,[{key:"componentDidMount",value:function(){console.log("componentDidMount. user: ",this.client.user),this.imagesClient.getImages(this.handleStates)}},{key:"componentDidUpdate",value:function(e,t,n){""!==this.client.user&&t.response!==this.state.response&&this.parseImages()}},{key:"render",value:function(){return!1}}]),n}(a.a.Component),B=function(e){return Object(T.jsx)("div",{className:"whitespace",children:e.isAnonymous?"Login to see and add images":[Object(T.jsx)("div",{className:"addphoto__whitespace",onClick:S.form.openButton.onClick.bind(undefined,y.PhotoFormRef),children:"Add photo"},"addphoto_whitespace"),Object(T.jsx)("span",{className:"addphoto_span",children:"to see images"},"addphoto_span")]})},M=new _;var J=function(){var e=Object(r.useState)([null,null]),t=Object(i.a)(e,2),n=t[0],a=t[1],o=Object(r.useState)(void 0),s=Object(i.a)(o,2),c=s[0],l=s[1],u=M.user,d={smallerThan700:Object(q.useMediaPredicate)("(max-width: 700px)"),smallerThan850:Object(q.useMediaPredicate)("(max-width: 850px)"),smallerThan1304:Object(q.useMediaPredicate)("(max-width: 1304px)")},h=E.Three;return d.smallerThan850?h=E.One:d.smallerThan1304&&(h=E.Two),Object(T.jsxs)(T.Fragment,{children:[Object(T.jsx)(I,{}),Object(T.jsx)(U,{username:u}),Object(T.jsx)(L,{}),Object(T.jsxs)("div",{className:"wrapper",children:[Object(T.jsx)(N,{isWindow:d,username:u,setFilterImages:l}),n.length>0?Object(T.jsx)(A,{columnCount:h,filterImages:c,children:n}):Object(T.jsx)(B,{isAnonymous:""===u}),Object(T.jsxs)("footer",{children:[Object(T.jsx)("hr",{className:"hr__footer"}),Object(T.jsxs)("div",{className:"div__footer",children:["created by ",Object(T.jsx)("a",{href:"https://github.com/serje3",className:"username__footer",children:"serje3"})," - devChallenges.io"]})]})]}),Object(T.jsx)(D,{client:M,saveImage:function(e){return a(e)}})]})},z=(n(25),function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,27)).then((function(t){var n=t.getCLS,r=t.getFID,a=t.getFCP,o=t.getLCP,s=t.getTTFB;n(e),r(e),a(e),o(e),s(e)}))});s.a.render(Object(T.jsx)(a.a.StrictMode,{children:Object(T.jsx)(J,{})}),document.getElementById("root")),z()}],[[26,1,2]]]);
//# sourceMappingURL=main.16c85a65.chunk.js.map